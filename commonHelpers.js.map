{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\naxios.defaults.baseURL = \"https://pixabay.com\";\nconst API_KEY = \"44363127-b4cd04443a44f0f2a63a731a6\";\n\n\n\nexport default async function getImages(query, currentPage){\n  const params = new URLSearchParams({\n    key: API_KEY,\n    q: query, \n    image_type: \"photo\",\n    orientation: \"horizontal\",\n    safesearch: true,\n    page: currentPage,\n    per_page: 15,\n  });\n\n  const response = await axios.get(\"/api/\", { params });\n  return response.data;\n}\n","export default function renderImages(images){\n  const list = document.querySelector('.gallery');\n  // list.innerHTML = '';\n\n  const markup = images.map(image => {\n    return `\n    <li class=\"card\">\n    <a class=\"card-link\" href=${image.webformatURL}>\n      <img src=\"${image.webformatURL}\" alt=\"${image.tags}\">\n      <div class=\"stats\">\n        <div class=\"stats-item\">\n          <p class=\"elements\">Likes</p>\n          ${image.likes}\n        </div>\n        <div class=\"stats-item\">\n          <p class=\"elements\">Views</p>\n          ${image.views}\n        </div>\n        <div class=\"stats-item\">\n          <p class=\"elements\">Comments</p>\n          ${image.comments}\n        </div>\n        <div class=\"stats-item\">\n          <p class=\"elements\">Downloads</p>\n          ${image.downloads}\n        </div>\n      </div>\n    </li>\n  `;\n  }).join('');\n  return markup;\n}\n","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport getImages from \"./js/pixabay-api\"\nimport renderImages from \"./js/render-functions\"\n\n\nconst form = document.querySelector(\".gallery-form\");\nconst btnElem= document.querySelector(\".btn\");\nconst list = document.querySelector(\".gallery\");\nconst loader = document.querySelector(\".js-loader\");\nconst btnLoadMore = document.querySelector(\".load-more\")\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captions: true,\n  captionsData: 'alt',\n  captionDelay: 250,\n  captionPosition: 'bottom',\n});\n\nlet inputValue = \"\";\nlet currentPage = 1;\nlet maxPage = 1;\n\nform.addEventListener(\"submit\", async (e)=> {\n  e.preventDefault();\n  inputValue = e.target.elements.text.value.trim();\n  console.log(inputValue);\n  currentPage = 1;\n  if (inputValue === \"\"){\n    iziToast.error({\n      message: 'Please enter a search query!',\n    });\n    return;\n  }\n  hideLoadBtn();\n  showLoader();\n  try {\n    const data = await getImages(inputValue, currentPage)\n    if (data.hits.length === 0) {\n      list.innerHTML = '';\n      iziToast.error({\n        message: 'Sorry, there are no images matching your search query. Please try again!',\n      });\n      hideLoader();\n      return;\n    }\n    maxPage = Math.ceil(data.totalHits / 15);\n    const markup = renderImages(data.hits);\n    list.innerHTML = markup;\n    updateBtnStatus();\n\n    lightbox.refresh();\n  } catch {\n    iziToast.error({\n    title: 'Error',\n    message: 'Catch error',\n    });\n  }\n    hideLoader();\n\n    e.target.elements.text.value = \"\";\n});\n\nbtnLoadMore.addEventListener(\"click\", async (e)=> {\n  currentPage++;\n  showLoader();\n  try{\n    const data = await getImages(inputValue, currentPage)\n    const markup = renderImages(data.hits);\n    list.insertAdjacentHTML(\"beforeend\", markup);\n    updateBtnStatus();\n    lightbox.refresh();\n    skipOldElements();\n  } catch {\n    iziToast.error({\n    title: 'Error',\n    message: 'Catch error',\n    });\n  }\n  hideLoader();\n});\n\nfunction updateBtnStatus() {\n  if(currentPage >= maxPage){\n    hideLoadBtn();\n    iziToast.info({\n    message: 'We are sorry, but you have reached the end of search results.',\n  });\n  } else {\n    showLoadBtn();\n  }\n}\n\nfunction showLoader(){\n  loader.classList.remove(\"hidden\");\n}\n\nfunction hideLoader(){\n  loader.classList.add(\"hidden\")\n}\n\nfunction showLoadBtn(){\n  btnLoadMore.classList.remove(\"hidden\");\n}\n\nfunction hideLoadBtn(){\n  btnLoadMore.classList.add(\"hidden\")\n}\n\nfunction skipOldElements(){\n  const liElem = list.children[0];\n  if (liElem) {\n    const height = liElem.getBoundingClientRect().height;\n    window.scrollBy({\n      top: height * 2,\n      behavior: \"smooth\",\n    });\n  }\n}"],"names":["axios","API_KEY","getImages","query","currentPage","params","renderImages","images","image","form","list","loader","btnLoadMore","lightbox","SimpleLightbox","inputValue","maxPage","e","iziToast","hideLoadBtn","showLoader","data","hideLoader","markup","updateBtnStatus","skipOldElements","showLoadBtn","liElem","height"],"mappings":"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"}